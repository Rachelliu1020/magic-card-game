<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Magic Cards/rules</title>
<link rel="stylesheet" href="game.css">
<script>
var ctx; 
var canvas; 
var buttonAudio;
var backgroundAudio;
var startButton;
var startClicked;
var soundAble=true;

function drawPage(){
	canvas = document.getElementById("myCav");
	ctx = canvas.getContext("2d");
	//background image;
    backgroundImage=new Image();
	backgroundImage.src="image/background0.png";
	ctx.drawImage(backgroundImage, 0, 0);
checkAudioImage = setInterval(function(){checkReadyState();},1000);
 
	//start button
	buttonX=70;
	buttonY=400;
	buttonWidth=192;
	buttonHeight=52;
	startButton=new Image();
	startButton.src="image/startButton.png";
	startClicked=new Image();
	startClicked.src="image/startClicked.png";
	
	//pause soundAble in URL
	//soundAble=decodeURIComponent(location.search.substr(location.search.indexOf("sound=")+6));
	//soundAble=((soundAble=="true"||soundAble=="")? true :false);
	soundAble=((getCookie("soundCookie")=="true")? true :false);
	//background audio
	backgroundAudio = new Audio("sounds/homeBg.wav");
	backgroundAudio.loop = true;
	backgroundAudio.volume = .25;
	backgroundAudio.load();
	if(soundAble){
	
	backgroundAudio.play();}else{backgroundAudio.pause();}
	
	//button audio 
	buttonAudio = new Audio("sounds/buttonClick.wav");
	buttonAudio.loop = false;
	buttonAudio.volume = .55;
	buttonAudio.load();
	
}


function checkReadyState() {
	if ( backgroundAudio.readyState==4 && buttonAudio.readyState == 4 && backgroundImage.complete && startButton.complete) {
		checkAudioImage=clearInterval(checkAudioImage);
		document.getElementById('loading').style.display = "none";
		document.getElementById('rules').style.display = "block";
		ctx.drawImage(startButton, buttonX, buttonY);
		
		//button listener
	canvas.addEventListener('click', clickButton, false);

	}
}
function clickButton(ev){
var mx; 
var my; 

var i; 

if (ev.layerX || ev.layerX == 0) { // Firefox 
mx = ev.layerX; 
my = ev.layerY; 
} else if (ev.offsetX || ev.offsetX == 0) { // Opera 
mx = ev.offsetX; 
my = ev.offsetY; 
} 
if (mx > buttonX && mx < (buttonX + buttonWidth) && my > buttonY && my < (buttonY + buttonHeight)) 
		{ 
	if(soundAble)buttonAudio.play();
	ctx.drawImage(startClicked, buttonX, buttonY);
	setTimeout(function(){window.location.href="game.html";},500);
	//setTimeout(function(){window.location.href="game.html?sound="+soundAble;},500);
	
	}

}
function getCookie(cookieName){
	if (document.cookie.length>0)
	{
	cookieStart=document.cookie.indexOf(cookieName + "=");
	if (cookieStart!=-1)
	{
	cookieStart=cookieStart + cookieName.length+1;
	cookieEnd=document.cookie.indexOf(";",cookieStart);
	if (cookieEnd==-1) cookieEnd=document.cookie.length;
	return unescape(document.cookie.substring(cookieStart,cookieEnd));
	}
	}
	return "";
}
</script>
</head>

<body onload="drawPage()">

<canvas id="myCav" width="320" height="480"
style="border:1px solid #c3c3c3;">
Your browser does not support the canvas element.
</canvas>
<!--no display image-->
<div id="images">
<img src="image/rulesBackground.png" alt="rule background shadow" width="30" height="30">
<img src="image/startButton.png" alt="start button" width="30" height="30">
<img src="image/background0.png" alt="background image" width="320" height="480">
</div>
<!--rules sentences-->
<div id="rules">
<p>Click to reveal the cards that do not contain the bombs. You score more if you can reveal cards in a very short time.</p>
</div>
<!--loading page-->
<div id="loading">LOADING...<p>Please wait</p></div>
</body>

</html>