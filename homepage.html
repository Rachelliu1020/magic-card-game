<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Magic Cards/homepage</title>
<link rel="stylesheet" href="game.css">
<script>
var ctx; 
var canvas; 
var buttonAudio;
var backgroundAudio;
var backgroundImage;
var pic1;
var pic2;
var pic3;
var pic4;
var playClicked;
//play button 
var buttonX=60;
var buttonY=370;
var buttonWidth=192;
var buttonHeight=52;
var soundButtonX=230;
var soundButtonY=120;
var soundButtonWidth=45;
var soundButtonHeight=47;
var soundAble=true;
var numClickSound=0;
//onload function
function onloadPage(){
	canvas = document.getElementById("myCav");
	ctx = canvas.getContext("2d");
	//background image;
    backgroundImage=new Image();
	backgroundImage.src="image/background0.png";
	ctx.drawImage(backgroundImage, 0, 0);
	//game name
	gameName=new Image();
	gameName.src="image/gameName.png";
	 
	//magic card pictures
	pic1=new Image();
	pic1.src="image/bomb.png";

	pic2=new Image();
	pic2.src="image/score.png";
	
	
	pic3=new Image();
	pic3.src="image/info.png";

	pic4=new Image();
	pic4.src="image/ssound.png";
	
	
	//play button
	playButton=new Image();
	playButton.src="image/playButton.png";
	playClicked=new Image();
	playClicked.src="image/playClicked.png";
	//sound button 
	soundButton=new Image();
	soundButton.src="image/sound.png";
	nosoundButton=new Image();
	nosoundButton.src="image/nosound.png";
	//background audio
	backgroundAudio = new Audio("sounds/homeBg.wav");
	backgroundAudio.loop = true;
	backgroundAudio.volume = .25;
	backgroundAudio.load();
	backgroundAudio.play();
	//button audio 
	buttonAudio = new Audio("sounds/buttonClick.wav");
	buttonAudio.loop = false;
	buttonAudio.volume = .55;
	buttonAudio.load();
	checkAudioImage = setInterval(function(){checkReadyState();},1000);
	
	setCookie("soundCookie",soundAble,365);
}
function checkReadyState() {
	if ( backgroundAudio.readyState==4 && buttonAudio.readyState == 4 && backgroundImage.complete && pic1.complete && pic2.complete && pic3.complete && pic4.complete) {
		checkAudioImage=clearInterval(checkAudioImage);
		document.getElementById('loading').style.display = "none";
		ctx.drawImage(gameName, 15, 40);
		ctx.drawImage(pic1, 60, 140);
		ctx.drawImage(pic2, 160, 140);
		ctx.drawImage(pic3, 60, 240);
		ctx.drawImage(pic4, 160, 240);
		ctx.drawImage(playButton, buttonX, buttonY);
		ctx.drawImage(soundButton, soundButtonX, soundButtonY);
		
		//button listener
		canvas.addEventListener('click', clickButton, false);

	}
}
function clickButton(ev){
var myX; 
var myY; 

var i; 

if (ev.layerX || ev.layerX == 0) { // Firefox 
myX = ev.layerX; 
myY = ev.layerY; 
} else if (ev.offsetX || ev.offsetX == 0) { // Opera 
myX = ev.offsetX; 
myY = ev.offsetY; 
} 
if (myX > buttonX && myX < (buttonX + buttonWidth) && myY > buttonY && myY < (buttonY + buttonHeight)) 
		{ 
	if(soundAble) buttonAudio.play();
	ctx.drawImage(playClicked, buttonX, buttonY);
	setTimeout(function(){window.location.href="rulesPage.html"},500);
	//setTimeout(function(){window.location.href="rulesPage.html?sound="+soundAble;},500);
	}
if(myX > soundButtonX && myX < (soundButtonX + soundButtonWidth) && myY > soundButtonY && myY < (soundButtonY + soundButtonHeight)){
numClickSound++;
if(numClickSound%2==1){
backgroundAudio.pause();

soundAble=false;
setCookie("soundCookie",soundAble,365);
ctx.drawImage(nosoundButton, soundButtonX, soundButtonY);

}else{
soundAble=true;
backgroundAudio.play();
setCookie("soundCookie",soundAble,365);
ctx.drawImage(soundButton, soundButtonX, soundButtonY);
}

}

}
function setCookie(cookieName,cookieValue,expireDays){
	var exdate=new Date();
	exdate.setDate(exdate.getDate()+expireDays);
	document.cookie=cookieName+ "=" +escape(cookieValue)+
	((expireDays==null) ? "" : ";expires="+exdate.toGMTString());
}

</script>
</head>

<body onload="onloadPage()">

<canvas id="myCav" width="320" height="480"
style="border:1px solid #c3c3c3;">
Your browser does not support the canvas element.
</canvas>

<div id="images">
<img src="image/gameName.png" alt="game name" width="30" height="30">
<img src="image/homepage_icon105.png" alt="card example" width="30" height="30">
<img src="image/homepage_icon118.png" alt="card example" width="30" height="30">
<img src="image/homepage_iconbomb1.png" alt="card example" width="30" height="30">
<img src="image/homepage_icon124.png" alt="card example" width="30" height="30">
<img src="image/playButton.png" alt="play button" width="30" height="30">
<img src="image/background0.png" alt="background image" width="320" height="480" >
</div>

<div id="loading">LOADING...<br><br>Please wait</div>
</body>

</html>